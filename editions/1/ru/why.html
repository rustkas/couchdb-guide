<title>Why CouchDB?</title>

<meta charset="utf-8" />

<link rel="stylesheet" href="../../../style.css" />

<link rel="prev" href="preface.html" />

<link rel="next" href="consistency.html" />

<script src="../../../script.js"></script>

<h2 id="why">Для чего необходима CouchDB?</h2>

<p>
  Apache CouchDB является одной из систем управления базами данных (NoSQL). 
  Это глава даёт объяснение зачем нужны новые системы, а также мотивы побудившие 
  создать CouchDB.
</p>
<p>
  Нам, как разработчикам CouchDB очень нравится использовать свою разработку. В этой главе мы поделимся с вами причинами нашего энтузиазма. Мы покажем вам, как модель данных на основе документов CouchDB подстраивается под требования программных продуктов, как обработчик запросов справляется со своей работой (использование и обработка данных). Кроме того мы продемострируем как архитектурные решения CouchDB используют принципы модульности и масштабируемости.
</p>

<h3 id="relax">Relax</h3>

<p>
  Если надо было бы найти точное слов описывающее CouchDB, это было бы слово <em>relax</em>. 
  Это и название заголовка книги, это и подпись к официальному логотипу CouchDB. Кроме того, 
  когда вы начинаете работать с базой системой управления базой данных (СУБД) CouchDB вы 
  видите надпись:
</p>

<pre>
Apache CouchDB has started. Time to relax.
</pre>

<p>
  Почему за relax (непринужденный отдых) так важен в работе с CouchDB? Для этого 
  есть множество причин. Производительность разработчиков резко возросло в 
  последние годы. Основной причиной этого можно назвать улучшение вспомогательных
  средств разработки и упрощения их использования. Например, если посмотреть на 
  инфраструктуру Ruby on Rails. Это весьма сложный фреймворк. Но в тоже время 
  начать работу с ним довольно-таки легко. Успех Ruby on Rails обусловлен простотой
  его дизайна. Это одна из причин почему CouchDB обращает внимание на удобство использования.
  Обучение CouchDB и изучение основных концепций является простым в изучении для 
  всех кто работает с Web технологиями. Также немаловажно, что концепции CouchDB 
  можно объяснить простым языком нетехническим специалистам.
</p>

<p>
Само по себе тот факт, что творческие люди пытаются создать специализированные 
решения является важной особенностью. В этом деле CouchDB помогает сделать всё правильно.
Мы считаем что существующие решения неоправданно сложными при разработке и при использовании.
Мы решили сделать разработку на CouchDB простой и даже приятной. Главы <a href="tour.html">3</a> и 
<a href="api.html">4</a> интуитивно понятную работу с основанную на протоколе HTTP REST API.
</p>

<p>
Другой приятной частью работы с CouchDB является настройка опций работающей базы данных.
Если у вас приложение использует базу данных CouchDB, то конечно очень важно не нарушить 
его работу. Внутренняя архитектура CouchDB терпимо относится к возможным ошибкам и 
имеет возможно точной локализации и изоляции. Т.е. возможная проблема не будет каскадным 
образом влиять на работе серверной системы.
</p>

<p>
Ключевые концепции CouchDB одновременно просты (в тоже время имеют мощный потенциал) и понятны.
Команда разработчиков (если у вас есть команда) может не бояться непредсказуемого поведения и
неуловимых ошибок. Если что-либо пойдёт не так, вы довольно-таки легко можете локализовать
проблему. Правда такие ситуация довольно-таки редки.
</p>

<p>
Архитектура CouchDB позволяет регулировать загрузку сетевой активности. Например, если
внезапно трафик к содержимому сайта увеличился (произошел внезапный всплеск), CouchDB 
может обработать множество запросов параллельно без отказа от обслуживания. Это, конечно, 
может некоторым образом увеличить время обработки запросов, но всё-таки все они будут обработаны.
Как только повышенная нагрузка прекратиться, CouchDB будет снова работать в нормальном режиме.
</p>

<p>
  Важной область, в которой CouchDB может вам быть полезен - сокращение расходов 
  (оборудования). Это обычно весьма сильно влияет на процесс <em>масштабирования</em>.
  CouchDB применяет ограничения, которые на первый взгляд могут показаться негибкими.
  Но в тоже время эти архитектурные решения позволяют проводить масштабирование. 
  Мы подробнее рассмотрим тему масштабирования в CouchDB <a href="index.html#part/iv">Часть IV, "Развёртывание CouchDB"</a>.
</p>

<p>
В двух словах: CouchDB не позволяет вам делать вещи, которые могли бы получить вас в беде
  позже. Это иногда означает, что вам придется разучиться лучшие практики, которые вы могли бы
  подобрали в текущей или прошлой работе.
  <a href="recipes.html">Глава 24, Рецепты</a> содержит список распространенных задач
  и как их решить в CouchDB.

  Если коротко: CouchDB оберегает вас от поступок, которые могли бы привести вашу 
  систему в нерабочее состояние в будущем. Это означает, что вам придётся отказаться 
  следовать шаблонным решениями, которые вы, возможно, использовали в работе с другими 
  СУБД. <a href="recipes.html">Глава 24, Рецепты</a> содержит список проблем и решений.
</p>

<h3 id="different">Иной способ моделирования данных</h3>

<p>
  Мы считаем, что CouchDB радикально изменит способ построения приложений
  на основе документов. CouchDB сочетает в себе модель интуитивно понятного хранения 
  документов с мощным механизмом запросов. Вы даже можете спросить себя: "Почему же 
  раньше не было придумано ничего подобного?"
</p>

<blockquote>
  <p>
    С помощью Django можно создавать <em>для</em> Web, но CouchDB позволяет <em>создавать</em>
    Web. Я никогда ранее не видел программного обеспечения, которое так полно 
	применило бы философию HTTP. Концепции CouchDB делают Django устаревшим также, как в своё 
	время Django сделало устаревшим ASP.
   </p>

  <p class="attribution">&mdash;Jacob Kaplan-Moss, разработчик Django</p>
</blockquote>

<p>
  Архитектура CouchDB много позаимствовала от веб-архитектуры: концепции ресурсов,
  методов и представлений. Все это усиливается запросами, картами и фильтрами данных.
  Отказоустойчивость, экстремальное масштабируемость, инкрементная репликация всё это 
  делает CouchDB просто идеальным решениям для баз данных на основе документов.
</p>

<h3 id="better">Хорошо подходит для создания приложений общего назначения</h3>

<p>
Мы создали программное обеспечение, чтобы упростить свою работу и работу других людей.
Хорошим примером может быть работа, в котором содержится множество разной информации: 
контакты, счета-фактуры или квитанции. Эти данные надо вносить, изменять и/или удалять.
CouchDB хорошо подходит для создания приложений общего назначения, например, таких, которое 
мы описываем. В этом заключается идея модели данных - самодостаточных документов.
</p>

<h4 id="containment">Данные без внешних зависимостей</h4>

<p>
  Счет-фактура содержит всю информацию об одной сделка - имя продавца, покупателя, 
  дата продажи, список проданных товаров или услуги. Как показано на 
  <a href= "#figure/1">Рисунок 1, "Автономные документы"</a>, здесь нет ссылок 
  на абстрактные бумаги или какой-либо иную часть бумаги с именем продавца и его адресом.
  Бухгалтеры любят простому - всё в одном месте. Программисты также это ценят.
</p>

<div class="figure" id="figure/1">
  <img src="why/01.png" />

  <p class="caption">Рисунок 1. Автономные документы</p>
</div>

<p>
  Тем не менее ссылочная модель данных активно используются в реляционных базах данных! 
  Каждый счет хранится в таблице в виде строки, которая ссылается на другие строки
  в других таблицах - одна строка для информации о продавце, одна о покупателе, одна строка для
  каждого элемента счёта. Остальные строки счёта нужны, чтобы описать детали элемента,
  детали изготовления, и так далее и так далее.
</p>

<p>
  Это, конечно, не сводит на нет значимости реляционной модели данных. Она широко 
  распространена и весьма полезна по ряду причин. К сожалению, она не подходит всегда, 
  что мы хотели продемонстрировать данным примером из реального мира.
</p>

<p>
  Для иллюстрации различных подходов к моделированию данных рассмотрим простую базу 
  данных контактов. Одна модель "болле" близка к реальным аналогам - это стопка визитных
  карточек (визиток). Так же, как наш пример со счет-фактурами, визитная карточка
  содержит всю важную информацию в себе. Мы зовем это "самодостаточные" данные, и это 
  важная концепция в понимании СУБД основанных на документах, таких как CouchDB.
</p>

<h4 id="information">Синтаксис и семантика</h4>

<p>
Большинство визитных карточек содержат примерно одну и ту же информацию — фамилию, имя,
отчество, принадлежность к какой-либо организации и некоторая контактная информация. 
Точная форма этой информации может варьироваться в зависимости от визитной карточи.
  В этом смысле визитную карточку можно охарактеризовать как <em>реальный документ</em>.
</p>

<p>
Визитная карточка Яна может содержать номер телефона, но не содержать номер факса, 
в то время как визитная карточка Дж. Криса содержит номер телефона и факса. Нет причин,
по которой Ян должен сделать его отсутствие факса явным, написав что-то вроде "факс: нет"
 на визитной карточке. Вместо этого просто пропустите факса означает, что у него его нет.
</p>

<p>
Мы видим, что реальные документы одного типа, такие как визитные карточки,
  как правило, очень похожи в <em>семантике</em> — вид информации, которую они
  передают - но они могут сильно отличаться в <em>синтаксисе</em>, или в её структуре. 
  Это как быть людьми. Разнообразие и многообразие - это хорошо и естественно.
</p>

<p>
В то время как традиционная реляционная база данных требует моделирования данных
  <em>сначала</em>, архитектура CouchDB не предполагает этого. Эта особенность 
является мощным способом агрегирования данных <em>после</em>, так же, как мы делаем с
  реальными документами. Мы подробно рассмотрим, как разрабатывать приложения с
  этой парадигмой хранения данных.
</p>

<h3 id="blocks">Строительные блоки для больших больших систем</h3>

<p>
CouchDB сама по себе является удобной системой хранения. Вы можете построить множество 
приложений с помощью инструментов, которые предоставляет СУБД CouchDB. В тоже время,
 архитектура CouchDB сконструирована и для более сложных задач. Её компоненты можно 
 использовать, как строительные блоки, которые разрешают проблемы хранения данных 
 больших и сложных систем.
</p>

<p>
Совершенно не важно, нужна ли вам система, которая имеет большую скорость обработки данных, 
но при этом не слишком надежна (ведение журнала), или такая, который гарантирует хранение 
в двух или более физически разделенные местоположениях для надежности, но вы готовы при 
этом не очень быстрая, CouchDB позволяет создавать такие системы.
</p>

<p>
Существует множество настроек, чтобы сделать систему более производительной в одругой параметры 
могут ухудшиться. Примером может служить теорема CAP (известная также как теорема Брюера). Этот 
эффект будет обсуждаться в следующей главе. На рисунках придставлены примеры зависимостей, которые 
есть в системах хранения даных - <a href= "#figure/2" >2</a> и <a href= "#figure/3">3</a>.
</p>

<p>
Сокращая задержку для данной системы (и это верно не только для хранилища
систем), вы влияете на возможности параллелизма и пропускной способности.
</p>

<div class="figure" id="figure/2">
  <img src="why/02.png" />

  <p class="caption">Рисунок 2. Пропускная способность, задержка или параллелизм</p>
</div>

<div class="figure" id="figure/3">
  <img src="why/03.png" />

  <p class="caption">
    Рисунок 3. Масштабирование: запросы на чтение, запросы на запись или данные
  </p>
</div>

<p>
Если вы хотите уменьшить масштаб, есть три различных параметра, на которые вы можете 
повлиять: масштабирование запросов на чтение, запросов на запись и данные. Ортогонально всем трем и
   на элементы, показанные на рисунках <a href="#figure/2">2</a> и
   <a href="#figure/3">3</a> - это еще много атрибутов, таких как надежность или
   простота. Вы можете нарисовать многие из этих графиков, которые показывают, как различные функции
   или атрибуты тянутся в разные стороны и таким образом формируют систему, которую они
   описать.
</p>

<p>
CouchDB очень гибок и дает вам достаточно строительных блоков для создания
   система в форме, которая может решить ваши конкретные задачи. В тоже время это 
совсем не значит, что CouchDB может применимо для решения любую проблему.
CouchDB - не является универсальным решением, а в области хранение данных. На это нужно время.

</p>

<h4 id="replication">Репликация с помощью CouchDB</h4>

<p>
Репликация CouchDB является одним из этих строительных блоков. Его основная функция
   синхронизировать две или более базы данных CouchDB. Это может показаться простым, но
   простота является ключом к разрешению репликации для решения ряда проблем:
   надежно синхронизировать базы данных между несколькими компьютерами; 
перенести данные в кластер экземпляров CouchDB, которые совместно используют подмножество
   от общего числа запросов, попавших в кластер (балансировка нагрузки); а также
   распределять данные между физически удаленными местами, такими, например, как один офис в
   Нью-Йорк и еще один в Токио.
</p>

<p>
Репликация CouchDB использует тот же API REST, который используют все клиенты. HTTP вездесущ
   и понятен. Репликация работает постепенно, то есть если во время
   репликация что-то идет не так (разрыв сетевого соединение), это будет учтено
 процесс продолжиться при как только соединение будет восстановлено. Это также только перенос 
 данных, которые необходимы для синхронизации баз данных.

</p>

<p>
Основная идея CouchDB состоит в том, что что-то может пойти не так, как работа сети,
   проблемы со связью, и задача СУБД в исправлении ошибок вместо того, чтобы предполагать,
 что все будет хорошо. Инкрементальный дизайн системы репликации показывает
   это лучше всего. Идеи, стоящие за «вещами, которые могут пойти не так», воплощены в
   <a href = "http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing"
     > Ошибки распределенных вычислений </ a>:
>
  Ошибки распределенных вычислений</a>:
</p>

<ol>
<li> Сеть надежна. </ li>

   <li> Задержка равна нулю. </ li>

   <li> Пропускная способность бесконечна. </ li>

   <li> Сеть защищена. </ li>

   <li> Топология не меняется. </ li>

   <li> Есть один администратор. </ li>

   <li> Транспортные расходы равны нулю. </ li>

   <li> Сеть однородна. </ li>
  
</ol>

<p>
Существующие инструменты часто пытаются скрыть тот факт, что есть сеть и что-либо
   или все предыдущие условия не существуют для конкретной системы. Это
   обычно приводит к фатальным ошибкам, когда что-то в итоге идет не так. В
   CouchDB, напротив, не пытается скрыть сеть; он просто обрабатывает ошибки
   изящно и сообщает, когда требуются действия с вашей стороны.
</p>

<h3 id="local">Локальные данные - короли данных</h3>

<p>
CouchDB переняла много полезных идей у Web. В тоже время есть одна вещь, которую
   что можно улучшить в Интернете: задержка. Всякий раз, когда вам придется ждать
   приложение для ответа или веб-сайт для отображения, вы почти всегда ждете
   подключение к сети, которое не так быстро, как вы хотите, на данный момент. В ожидании
   несколько секунд вместо миллисекунд сильно влияют на пользовательский опыт и, следовательно,
   удовлетворенность пользователей.

</p>

<p>
Что вы делаете, когда вы не в сети? Это происходит постоянно - ваш DSL или
   у провайдера кабельного телевидения есть проблемы, или у вашего iPhone, G1 или Blackberry нет полос, и
   отсутствие связи означает, что нет возможности получить доступ к вашим данным.
</p>

<p>
CouchDB может разрешить эту ситуации, и именно здесь масштабирование
   важно снова. На этот раз приложение сокращается. Представьте, что CouchDB установлен на
   телефоны и другие мобильные устройства, которые могут синхронизировать данные с централизованно
   размещенные CouchDB, когда они находятся в сети. Синхронизация не связана
   ограничениями пользовательского интерфейса, такими как время отклика в секунду. Легче
   настроить приложение для высокой пропускной способности и более высокой задержки, чем для 
низкой пропускной способности и очень низкой задержки. Мобильные приложения могут затем 
использовать локальную CouchDB для извлечения данных, и поскольку для этого не требуется удаленная сеть, задержка по умолчанию низкая.
</p>

<p>
  Вы действительно можете использовать CouchDB на телефоне? Erlang, реализация CouchDB
   язык был разработан для работы на встроенных устройствах, которые менее мощный, 
чем современные телефоны.
</p>

<h3 id="wrap">Заключение</h3>

<p>
В следующей главе более подробно рассматривается распределенная природа CouchDB. 
Надеюсь, что мы должны предоставили вам достаточно информации, чтобы разжечь ваш интерес 
к CouchDB. Продолжим наше путешествие!
  
</p>
